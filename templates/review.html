{% extends "layout.html" %}
{% block title %}리뷰 전체조회 | EWHA MARKET{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/review_style.css') }}">
{% endblock %}

{% block content %}
    <main class="review-page">
        <!-- 리뷰 제목 -->
        <h2 class="review-title">리뷰 전체 조회</h2>
        <!-- 리뷰 총 개수 텍스트 -->
        <p class="review-subtitle"> 총 {{ datas|length }}개의 리뷰 </p>

        <div class="review-grid">
        {% for p in datas %}
        <!-- 카드 전체를 상세보기 링크로 -->
        <a class="review-card" href="{{ url_for('reviews.view_review', review_id=p.id) }}">
            <div class="review-image">
                {% if p.img_path %}
                    <img src="{{ url_for('static', filename='images/' ~ p.img_path) }}">
                {% endif %}
            </div>
            <p class="review-text">{{ p.title }}</p>
            <div class="review-stars">
                {% set r = (p.rating or 0)|int %}
                {{ '★' * r }}{{ '☆' * (5 - r) }}
            </div>
            <div class="review-info">
                <span>{{ p.created_at or '' }}</span>
                <span>{{ p.purchaser or '' }}</span>
            </div>
        </a>

        {% endfor %}
    </div>

        <!-- 페이지네이션 -->
        <div class="pagination-section">

            <hr class="pagination-line" />
            <nav class="pagination" aria-label="pagination">
                {# 이전 버튼 #}
                {% if page > 1 %}
                    <a href="{{ url_for('reviews.view_reviews', page=page-1) }}"
                    class="page-num prev"
                    aria-label="Previous">‹</a>
                {% else %}
                    <span class="page-num prev disabled" aria-label="Previous">‹</span>
                {% endif %}

                {# 페이지 번호들 #}
                {% for p in range(1, page_count + 1) %}
                    {% if p == page %}
                        <span class="page-num active">{{ p }}</span>
                    {% else %}
                        <a href="{{ url_for('reviews.view_reviews', page=p) }}"
                        class="page-num">{{ p }}</a>
                    {% endif %}
                {% endfor %}

                {# 다음 버튼 #}
                {% if page < page_count %}
                    <a href="{{ url_for('reviews.view_reviews', page=page+1) }}"
                    class="page-num next"
                    aria-label="Next">›</a>
                {% else %}
                    <span class="page-num next disabled" aria-label="Next">›</span>
                {% endif %}

    </nav>
        </div>
    </main>

{% endblock %}