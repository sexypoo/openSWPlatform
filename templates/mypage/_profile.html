<div class="section-wrapper">

    <h2 class="section-title">회원정보</h2>

    <div class="profile-card">

        <div id="view-mode">
            <div class="info-item">
                <label>아이디</label>
                <div class="info-display">{{ user.id }}</div>
            </div>

            <div class="info-item">
                <label>비밀번호</label>
                <div class="info-display">********</div>
            </div>

            <div class="info-item">
                <label>이메일</label>
                <div class="info-display">{{ user.email }}</div>
            </div>

            <button onclick="toggleEditMode()" class="primary-btn">
                회원정보 수정하기
            </button>
        </div>

        <div id="edit-mode" style="display:none;">
            <form method="post" action="{{ url_for('user.update_profile') }}">

                <div class="info-item">
                    <label>아이디</label>
                    <div class="readonly-field">{{ user.id }}</div>
                </div>

                <div class="info-item">
                    <label>새 비밀번호 입력</label>
                    <input type="password" name="password_new" id="edit-password-new">
                    <p id="pw-warning" style="color:red; font-size:13px; margin-top:6px; display:none;">
                    현재 비밀번호와 동일합니다. 
                    </p> 
                </div>

                <div class="info-item">
                    <label>이메일</label>
                    <input type="email" name="email" value="{{ user.email }}">
                </div>

                <div class="button-group">
                    <button type="submit" class="save-btn">저장하기</button>
                    <button type="button" onclick="cancelEdit()" class="cancel-btn">취소</button>
                </div>

            </form>
        </div>

    </div>

</div>

<script>
function toggleEditMode() {
    document.getElementById("view-mode").style.display = "none";
    document.getElementById("edit-mode").style.display = "block";
}

function cancelEdit() {
    document.getElementById("edit-mode").style.display = "none";
    document.getElementById("view-mode").style.display = "block";
}
</script>

<script>
// 기존 edit toggle 기능
function toggleEditMode() {
    document.getElementById("view-mode").style.display = "none";
    document.getElementById("edit-mode").style.display = "block";
}
function cancelEdit() {
    document.getElementById("edit-mode").style.display = "none";
    document.getElementById("view-mode").style.display = "block";
}

// 새 비밀번호 검증 기능 
document.addEventListener("DOMContentLoaded", () => {
    const newPwInput = document.getElementById("edit-password-new");
    const warning = document.getElementById("pw-warning");

    if (!newPwInput) return;

    newPwInput.addEventListener("input", () => {
        const currentPw = "********";  // 화면에 표시되는 placeholder와 비교 방지
        const typed = newPwInput.value.trim();

        // 현재 비밀번호와 같다고 판단할 기준이 없으므로,
        // "placeholder 값 그대로"일 경우만 막음
        if (typed === "" || typed === currentPw) {
            newPwInput.classList.add("input-error");
            warning.style.display = "block";
        } else {
            newPwInput.classList.remove("input-error");
            warning.style.display = "none";
        }
    });
});
</script>

